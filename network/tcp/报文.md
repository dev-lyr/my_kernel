# 一 概述:
## (1)相关结构:
- struct tcphdr: tcp协议头部, 参考: include/linux/tcp.h.

# 二 TCP首部(固定20字节,最长60字节):
## (1)源端口和目的端口:
- 各占2个字节.

## (2)序号和确认号:
- 序号: 占4字节, 序号范围0~2的32次方-1, 序号增加到最大后又回到0, TCP是面向字节流的, 每个字节都顺序编号. 该字段表示: 本报文段所发送数据的第一个字节的序列号.
- 确认号: 占4字节, 是期望收到对方下一个报文段的第一个数据字节的序号.

## (3)数据偏移:
- 表示tcp报文段数据起始处距离整个报文起始处的距离, 即表示报文首部长度. 占4位, 单位是4字节, 因此tcp报文首部长度最大为60字节.

## (4)控制位(6 bit):
- URG: 与紧急指针配合使用, 当URG=1时, 发送进程告诉发送方的TCP有紧急数据传送, 于是发送方把紧急数据查到**本报文段数据**的最前面.
- ACK: 当ACK=1时确认号才有意义, TCP规定连接建立后必须把ACK设置为1.
- PSH
- RST: RST=1表示TCP连接中出现严重错误, 必须释放连接, 然后再新建立连接.
- SYN: 连接建立时用来同步序号, SYN=1且ACK=0表明是连接请求报文, 若同意返回SYN=1和ACK=1, 因此SYN=1表示是请求报文或连接接受报文.
- FIN: 用来释放一个连接,当FIN=1则表示发送方数据已发送完毕, 并要求释放连接.

## (5)窗口:
- 占2字节, 指发送方的接收窗口的大小, 以字节为单位.

## (6)校验和:
- 占2字节, 校验首部和数据.

## (7)紧急指针:
- 当URG=1时才有意义, 指出本报文段中紧急数据的字节数.
- 即使窗口为0, 紧急数据也可发送.

## (8)选项:
- 长度可变, 最长为40字节.